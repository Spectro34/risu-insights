---
# Install RISU via package manager
# NOTE : Archived
# Usage:
#   ansible-playbook install-risu-package.yml -i inventory/hosts
#   ansible-playbook install-risu-package.yml -i inventory/hosts --check  # Dry run

- name: Install RISU via package manager
  hosts: all
  become: yes
  gather_facts: yes
  
  tasks:
    - name: Display installation target
      debug:
        msg: |
          Installing RISU on: {{ inventory_hostname }}
          OS: {{ ansible_distribution }} {{ ansible_distribution_version }}
          Package Manager: {{ ansible_pkg_mgr }}
      tags: [always]
    
    # Install RISU using generic package module
    - name: Install RISU package
      package:
        name: risu
        state: present
      register: install_result
      tags: [install]
    
    # Verification
    - name: Verify risu command is available
      command: which risu
      register: risu_check
      changed_when: false
      failed_when: risu_check.rc != 0
      tags: [always, verify]
    
    - name: Get RISU version
      command: risu --version
      register: risu_version
      changed_when: false
      tags: [always, verify]
    
    - name: Test RISU functionality
      command: risu --list-plugins
      register: plugin_test
      changed_when: false
      tags: [verify]
    
    - name: Display installation summary
      debug:
        msg: |
          RISU Installation Complete
          
          Host: {{ inventory_hostname }}
          Command: {{ risu_check.stdout }}
          Version: {{ risu_version.stdout_lines[0] | default('Unknown') }}
          Plugins: {{ plugin_test.stdout_lines | length }}
      tags: [always]

